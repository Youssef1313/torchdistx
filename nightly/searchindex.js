Search.setIndex({docnames:["deferred_init","fake_tensor","fake_tensor_and_deferred_init","gossip_grad","index","slow_momentum_fsdp"],envversion:{"sphinx.domains.c":2,"sphinx.domains.changeset":1,"sphinx.domains.citation":1,"sphinx.domains.cpp":4,"sphinx.domains.index":1,"sphinx.domains.javascript":2,"sphinx.domains.math":2,"sphinx.domains.python":3,"sphinx.domains.rst":2,"sphinx.domains.std":2,"sphinx.ext.intersphinx":1,"sphinx.ext.todo":2,"sphinx.ext.viewcode":1,sphinx:56},filenames:["deferred_init.rst","fake_tensor.rst","fake_tensor_and_deferred_init.rst","gossip_grad.rst","index.rst","slow_momentum_fsdp.rst"],objects:{"torchdistx.deferred_init":[[0,0,1,"","deferred_init"],[0,0,1,"","materialize_module"],[0,0,1,"","materialize_tensor"]],"torchdistx.fake":[[1,0,1,"","fake_mode"],[1,0,1,"","is_fake"],[1,0,1,"","meta_like"]],"torchdistx.gossip_grad":[[3,0,1,"","GossipGraDState"],[3,1,1,"","Topology"],[3,1,1,"","gossip_grad_hook"]],"torchdistx.slowmo.slowmo_comm":[[5,1,1,"","SlowMoState"],[5,0,1,"","slowmo_hook"]],"torchdistx.slowmo.slowmo_optimizer":[[5,1,1,"","SlowMomentumOptimizer"]]},objnames:{"0":["py","function","Python function"],"1":["py","class","Python class"]},objtypes:{"0":"py:function","1":"py:class"},terms:{"0":[0,3,5],"00":0,"0000e":0,"1":[0,2,5],"10":[0,1,3,5],"1e":5,"2":[2,5],"200":5,"24":0,"2403":3,"2nd":3,"3":[0,2],"3d":0,"4":[0,3,5],"4013e":0,"41":0,"45":0,"4677e":0,"48":5,"4th":3,"5":[0,5],"5915e":0,"6":5,"6th":5,"8gb":1,"boolean":0,"case":[0,2,4],"catch":2,"class":[0,2,3,5],"default":[2,3,5],"do":[0,4],"final":3,"float":[0,5],"function":[0,1,2],"import":[0,1,3,5],"int":[0,3,5],"new":2,"return":[0,1,2],"short":4,"super":[0,2],"true":[0,1,2,5],"while":[0,2],A:[0,2,3,5],As:[0,2,5],At:0,By:3,For:[0,1,3],If:[0,1,2,5],In:[0,1,2,4],It:[0,2],On:2,Or:0,The:[0,1,2,5],There:[1,2],To:5,With:[0,2],_:5,__init__:[0,2],abi:4,abl:[0,2],abov:[0,2],acceler:0,accept:0,access:[0,2],accompani:0,accuraci:5,across:[3,5],act:[1,2],action:2,actual:2,add_:2,addit:2,address:[0,2],advis:4,affect:2,aforement:2,after:0,albeit:0,algorithm:[3,5],all:[0,1,2,4,5],all_reduc:3,alloc:[0,1,2],allow:1,almost:0,along:0,alreadi:[1,2],also:[0,1,2],altern:[1,2],although:[0,2,4],alwai:[0,1,2],an:[0,1,2,3,4,5],ani:[0,1,2,4,5],anoth:2,api:[2,4],appear:0,appli:0,approach:[0,2],ar:[0,1,2,3,4,5],arbitrari:[0,5],architectur:[0,1],arg:0,argument:[0,2],associ:2,assum:2,aten:2,attempt:2,autograd:[0,1,2],autom:0,avail:[1,2,5],averag:5,avoid:0,awar:2,b:[1,2],back:2,backend:[0,1,2,3],backendselect:2,backpropag:3,backward:5,base:[0,2,3,5],base_optim:5,batch:[3,5],becaus:2,becom:0,befor:[0,2,3,4,5],behav:2,behavior:1,behind:2,being:0,belong:[3,5],below:[0,2],best:[0,4],between:[2,4,5],beyond:2,bidirect:2,big:0,blenderbot:1,blenderbotconfig:1,blenderbotmodel:1,blob:0,block:1,bool:[0,1,5],both:2,bound:[1,2],broadcast:3,buf1:2,buf2:2,buffer:0,buffers_onli:0,build:1,built:2,c10:2,call:[0,2,3],callabl:0,can:[0,1,2,3,4],cannot:[0,1,2],capac:0,captur:2,care:5,carri:1,categori:2,caus:2,caution:4,chang:[0,3,4],check:[0,1,4],check_fn:0,chicken:0,chronolog:2,clearli:0,close:1,code:2,collect:4,come:2,common:4,commun:[4,5],compat:4,complet:[0,2],complex:2,compos:3,comput:[0,3],computation:0,concept:2,configur:5,consid:[0,1,2,3,4],consist:[0,1,5],construct:[0,1,2],constructor:0,consum:1,contain:[0,2,3,4],context:1,contradict:2,conveni:1,convent:2,copi:1,core:[0,2,4],correct:0,correctli:[0,2],could:2,counter:0,cousin:1,cpu:[0,1,2],creat:5,cube:3,cuda:[1,2,3],culprit:0,cur_subgroup:5,current:[0,3,5],data:[0,1,2],decid:0,decis:0,deepspe:0,def:[0,2],defer:[1,4],deferr:0,deferred_init:[0,2],deferredinit:2,defin:5,deliber:0,demonstr:0,descend:0,describ:2,descript:2,design:2,detach:1,detail:2,detect:0,determin:[0,2],devic:[0,1,2,3],differ:[0,1],disabl:5,dispatch:2,dispatchkeyset:2,dispos:[0,2],dissemin:3,dist:[3,5],distribut:[0,3,5],dive:2,diverg:0,divert:2,divis:5,document:2,doe:[0,3],don:2,dr:4,dry:0,dtype:2,due:2,dure:[0,3],e:[0,2,3,5],each:3,earlier:2,easi:0,effect:2,effici:[3,5],effort:[0,4],egg:0,either:0,element:2,els:2,enabl:[0,5],end:0,ensur:2,entri:0,environ:3,epilogu:2,error:0,essenti:2,etc:3,even:[0,1,2],ever:0,everi:[3,5],exact:5,exampl:[1,2,3,4,5],exce:0,except:0,exercis:4,expect:[0,2],expens:0,explicitli:0,expos:2,extern:0,extract:2,facilit:2,factor:5,factori:2,fail:[0,2],failur:4,fairli:[0,2],fake:[0,4],fake_cuda:1,fake_mod:1,faketensorimpl:2,fallback:2,fals:[0,1,5],familiar:2,fashion:[3,5],feasibl:5,featur:0,feedback:4,first:2,fit:[0,1],fly:0,follow:[0,1,2,3,5],foo:2,forc:[0,1,2],form:[0,2],fortun:0,forward:2,framework:5,frequent:2,from:[0,1,2,3,4,5],from_numpi:[0,2],fsdp:[0,3,5],fsdp_net:[3,5],fsdp_net_slowmo:5,fulli:0,fullyshardeddataparallel:4,futur:[0,2],fx:0,g:0,gather:4,gener:[0,1,3,5],get_num_modul:3,give:2,global:[2,3],go:5,goal:2,good:1,gossip:3,gossip_grad:3,gossip_grad_hook:3,gossip_period:3,gossipgrad:4,gossipgradst:3,gpu:3,grad:[3,5],grade:1,gradient:[3,5],graph:[0,1,2],group:3,guarante:[0,4],ha:[0,1,2,3],hand:2,handl:2,handler:2,hang:3,happen:[2,3,5],have:[0,1,2],here:[2,3],heurist:2,hierarch:3,hijack:2,histor:2,hit:2,hold:[0,2],hook:[2,3,5],how:[1,3,5],howev:[0,1,2],hypercub:3,i:[0,2,3,5],identifi:3,ignor:[0,1],implement:[0,2,3,5],improv:[2,5],includ:4,increas:0,increasingli:0,incub:4,independ:2,indic:[0,1],individu:0,infer:0,inform:[0,3,5],initi:[1,3,4,5],insid:[0,2],inspect:[0,1],instanc:[0,1,2,5],instanti:[0,1],instead:2,instruct:4,integ:0,inter:3,intercept:2,interfac:[1,2],intern:[0,2],intra:[3,5],introduc:[0,2,4],intrus:0,intuit:2,involv:3,is_cuda:2,is_fak:1,issu:3,item:2,iter:5,its:[0,1,2,3,4],just:[1,2],k:0,keep:0,kei:2,kernel:2,keyword:0,kwarg:0,label:5,laptop:1,larg:[0,1,3],larger:0,lastli:2,later:[0,2],layer:1,lazi:0,lazy_m:0,lazylinear:0,lead:3,leak:0,learn:[0,1,5],leverag:2,li:2,librari:[0,2],lightweight:2,like:[1,2],limit:0,linear:[0,3,5],list:2,load:0,local:[3,5],local_process_group:3,logic:2,longer:0,look:2,loss:5,loss_fn:5,low:2,lr:5,m:[0,1],machin:0,main:[2,3],mainli:1,major:2,make:[0,4],manag:1,mani:[2,3],master:3,master_process_group:3,materi:2,materialize_modul:0,materialize_tensor:[0,2],materialized_param:0,mean:[0,1,2,4],meant:[0,1],mechan:2,member:5,memori:[0,2],mention:[0,2],messag:0,meta:[0,1],meta_lik:1,method:5,mitig:0,mix:2,model:[0,1,3,5],modifi:2,modul:[1,3,4,5],module_fn:0,momentum:4,more:[0,2,3],mostli:[1,2],motiv:2,much:0,must:3,mutabl:0,my_modul:2,mylargemodel:0,mylazymodul:0,mymodul:[0,2],naiv:2,nativ:2,natur:2,nccl:3,necessarili:[1,2],need:[0,2,3,5],neighbor:3,net:[3,5],never:2,new_subgroup:5,nn:[0,2,3,5],no_shard:4,node:[0,3,5],non:[0,2],none:[0,2,3],note:[0,2,3],notic:0,num_modul:3,num_nod:3,number:[0,3,5],numpi:[0,2],offer:[0,1,2],often:[0,5],onc:[0,2],one:[2,3],ones:[0,1,2],onli:[0,3,5],onto:0,opaquetensorimpl:2,oper:[0,1,2],optim:[0,5],option:0,order:[0,2],organ:3,origin:[1,2,3],other:[1,2],otherwis:[0,2,3],our:[2,4],out:[1,4],out_featur:0,output:[2,5],over:3,overal:2,overcom:0,packag:4,paper:3,parallel:0,param1:0,param:0,paramet:[0,1,2,3,5],part:[0,1,2],partial:0,particip:3,particular:2,partit:0,pass:[0,2,3],path:2,pattern:4,pc:1,pend:2,perform:[0,2,3,5],period:4,person:1,pg:3,pick:2,place:[0,2],plai:[0,2],plan:[2,4],pleas:[3,4],point:0,pose:2,posit:0,possibl:0,post:[2,5],practic:0,pre:[2,5],predefin:0,prevent:0,previou:0,primit:0,prior:3,prioriti:2,problem:4,proc_per_nod:3,process:3,processgroup:[3,5],product:4,prologu:2,properli:2,properti:[1,2,3],protocol:3,provid:3,proxi:2,purpos:[0,1],python:[1,2],pytorch:[0,2,4],quit:2,rais:0,ram:1,random:3,random_se:3,randomli:3,rang:5,rank:[3,5],rate:5,re:0,read:2,readm:4,real:[1,2],reason:[0,2],record:[0,2],reduc:[3,5],refer:[0,3],regist:[3,5],register_comm_hook:[3,5],regular:2,releas:[0,4],reli:[0,1,2],remain:2,replac:2,report:1,repres:0,requir:[0,2,5],requires_grad:0,result:5,revers:2,rich:0,rudimentari:0,rule:0,run:[0,5],s:[2,5],same:[0,1,2,3,5],scale:3,scope:[1,2],second:2,section:[0,4],see:[0,2],seed:3,self:[0,2],sens:[0,1,2,4],separ:[2,3],sequenti:0,serv:1,set:[2,3,5],set_data:2,set_devic:3,sgd:5,shadow:2,shape:[0,2],shard:[0,5],should:[3,4],show:1,signatur:0,similar:[0,1,2,3],simpl:[0,2],simplest:0,simpli:2,simplifi:2,sinc:[0,2],singl:0,singleton:2,sit:2,size:[0,1,3],skip:[0,2],slow:4,slowmo:5,slowmo_comm:5,slowmo_factor:5,slowmo_freq:5,slowmo_hook:5,slowmo_lr:5,slowmo_optim:5,slowmo_st:5,slowmomentumoptim:5,slowmost:5,small:2,smarter:0,snippet:2,so:3,sole:2,solut:0,some:[0,2],sophist:2,sourc:[0,1,3,5],specif:[0,2],specifi:[1,2,3,5],spot:0,src:2,stage:3,state:[0,3,5],step:[3,5],still:2,storag:[0,2],store:[3,5],straightforward:2,strategi:[0,4],stricter:0,structur:0,subclass:2,subgoup:5,subgroup:[3,5],subject:4,sublayer1:0,sublayer2:0,subset:0,succe:0,successfulli:2,summari:2,support:[0,2,3],sure:0,surprisingli:1,symbol:2,sync_grad:5,t:[0,1,2],tag:2,take:[0,5],team:[0,4],technic:2,techniqu:0,temporari:0,tensor:[0,3,4,5],tensorimpl:2,tensoropt:2,than:2,thei:[0,1,2],them:[0,2,4],thi:[0,1,2,3,4,5],those:2,though:[0,2],three:[0,2],threshold:0,through:2,time:[0,2],tl:4,togeth:3,tolist:0,too:0,tool:1,top:2,topic:2,topolog:[2,3],torch:[0,1,2,3,5],torchdistx:[0,1,3,4,5],torchscript:0,trace:[0,2],tracebl:2,tracer:2,track:0,tradeoff:1,train:[0,4],transform:1,transpar:2,two:[1,2],type:[0,1],unconvent:2,under:5,uneven:3,unexpect:3,unidirect:2,uniqu:2,unlik:[1,2],up:0,updat:[0,5],us:[0,2,3,4,5],user:[0,3,4],valu:[0,3,5],variable_data:2,variablehooksinterfac:2,variou:0,veri:2,version:[0,2],vertex:3,via:0,view:2,virtual:3,wa:[0,2],wai:2,want:4,we:[0,2,4],weight:0,well:2,were:[0,1,3],what:4,when:[0,2,3],where:[2,3,5],whether:[0,1],which:[0,1,2,3,4,5],whole:0,why:2,wise:0,within:[0,1,2,3],without:0,won:1,work:[0,2],workaround:0,worker:[3,5],worth:2,would:[0,2],wrap:[0,2,5],write:2,wrong:2,yet:0,you:[2,4],zero:2,zero_grad:5,zero_lik:2,zeros_lik:2},titles:["Deferred Module Initialization","Fake Tensor","Fake Tensors &amp; Deferred Module Initialization","GossipGraD communication strategy for <code class=\"docutils literal notranslate\"><span class=\"pre\">FullyShardedDataParallel</span></code> training with <code class=\"docutils literal notranslate\"><span class=\"pre\">NO_SHARD</span></code> strategy","Torch Distributed Experimental","Slow Momentum for <code class=\"docutils literal notranslate\"><span class=\"pre\">FullyShardedDataParallel</span></code> training with <code class=\"docutils literal notranslate\"><span class=\"pre\">NO_SHARD</span></code> strategy"],titleterms:{"case":1,api:[0,1,3,5],common:0,commun:3,defer:[0,2],design:4,distribut:4,document:4,dr:0,exampl:0,experiment:4,failur:0,fake:[1,2],featur:4,fullyshardeddataparallel:[3,5],gossipgrad:3,initi:[0,2],instal:4,introduct:2,materi:0,meta:2,method:2,modul:[0,2],momentum:5,mutabl:2,no_shard:[3,5],note:4,pattern:0,problem:[0,2],shortcom:2,slow:5,solut:2,strategi:[3,5],tensor:[1,2],tl:0,torch:4,train:[3,5],us:1,variabl:2,what:0}})